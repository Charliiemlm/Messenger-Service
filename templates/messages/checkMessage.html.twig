{% extends "base.html.twig" %}
{% block title %}
Main Page
{% endblock %}
{% block body %}
<div class="container">
   <div class="row justify-content-center">
      <div class="col-6">
         <br />
         <h1 class="text-center">Login de usuario</h1>
         <br />
         <!-- Si hay usuario logeado-->
         {% if app.user %}
         <h1>Welcome {{ app.user.name }}âœ…</h1>
         <br><br>
         <ul class="list-inline">
            <li class="list-inline-item">
               <!-- rutas por name de ruta -->
               <a href="{{ path('login') }}" class="btn btn-primary">Check Messages</a>
            </li>
            <li class="list-inline-item">
               <a href="{{ path('sendMessage') }}" class="btn btn-secondary">Send Message</a>
            </li>
            <li class="list-inline-item offset-md-5">
               <a href="{{ path('app_logout') }}" class="btn btn-secondary">Logout</a>
            </li>
         </ul>
         <table class="table table-striped table-hover">
            <tr class="table-primary">
               <th class="text-center">Email From</th>
               <th class="text-center">Subject</th>
               <th class="col-6 text-center">Message</th>
               <th class="text-center">Time</th>
            </tr>
            <!-- recorrer los mensajes recibidos del controller-->
            {% for message in messages %}
            <tr>
               <td class="text-center">
                  {{ message.emailfrom }}
               </td>
               <td class="text-center">
                  {{ message.subject }}
               </td>
               <td class="text-center">
                  {{ message.message }}
               </td>
               <td class="text-center">
                  {{ message.time|date('Y-m-d H:i:s') }}
               </td>
            </tr>
            {% endfor %}
         </table>
         {% else %}
         <!-- si no hay usuario logeado se envia a la pagina principal-->
         <script>
            window.location.href = "{{ path('optionsUser') }}"
         </script>
      </div>
   </div>
</div>
{% endif %}
{% endblock %}